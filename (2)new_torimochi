
########################################
## Fig. 2
########################################
#Svim (align Nanopore reads with ngmlr, then call SVs)
svim reads --nanopore BmN4_svim /home/kshoji/Gawain/NGSdata/191113BmN4genome_MINION.fastq /home/kshoji/Gawain/REFdata/Bomo_genome_assembly.fa            # 
#and check by eyes of output variants.vcf file

###Summary of SNPs information and extraction of expression levels for each SNPs###

#Align 220209_torimochi_newins.fas (torimochi sequences on various chromosomes as determined by Sanger sequencing.) with MEGA and export with fasta.
220209_torimochi_aln.fas

#Specify alignment file
snp-sites -v -o 220209_torimochi_aln0.vcf 220209_torimochi_aln.fas
sed s/^1/chr03_newins/ 220209_torimochi_aln0.vcf  > 220209_torimochi_aln.vcf 
#After this, rewrite the commented out contig ID in  220209_torimochi_aln.vcf


#Mapping by bowtie
bowtie-build torimochi03.fasta torimochi03

( bowtie --offrate 3 -p 20 -a --best --strata -v 3  -t --sam torimochi03 -f /home/kshoji/Gawain/NGSdata/181220_P1_Naïve_Total_NaIO4m_trim.fasta.gz  > 181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.sam )  
samtools view -@ 20 -bS 181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.sam > 181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.bam
bamToBed -i 181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.bam > 181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.bed


QQ="torimochi03"
for Q in ${QQ};do
NN="170124_OV1_MLVminus"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 3 -t --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${N}_trim2.fasta.gz  > ${N}_${Q}_bt.sam )  
	samtools view -@ 20 -bS ${N}_${Q}_bt.sam > ${N}_${Q}_bt.bam
bamToBed -i ${N}_${Q}_bt.bam > ${N}_${Q}_bt.bed
rm ${N}_${Q}.sam

done
done


####Open R to extract sequence information from bam file for BmN4 data####
R
library(Biostrings)
library(Rsamtools)

bam <- scanBam("181220_P1_Naïve_Total_NaIO4m_trim_trim_torimochi03_bt.bam")
#> names(bam[[1]])
# [1] "qname"  "flag"   "rname"  "strand" "pos"    "qwidth" "mapq"   "cigar" 
# [9] "mrnm"   "mpos"   "isize"  "seq"    "qual"  
chr3 <- bam[[1]]$rname == "chr03_newins"
chr3[is.na(chr3)] <- F
#head(bam[[1]]$pos[chr3])

pos <- bam[[1]]$pos[chr3]
qname <- bam[[1]]$qname[chr3]
qwidth <- bam[[1]]$qwidth[chr3]
cigar <- bam[[1]]$cigar[chr3]
seq <- bam[[1]]$seq[chr3]
qual <- bam[[1]]$qual[chr3]
strand <- bam[[1]]$strand[chr3]


seq2 <- seq
for(i in 1:8725){

tag <- pos ==i
ins <- paste(rep("N",i-1),collapse="")

seq2[tag] <- paste0(ins,seq[tag])

cat(i)
}

write.table(t(consensusMatrix(seq2[strand=="+"])[1:4,]),"210329_torimochi03_variant_table_sense.txt",sep="\t",quote=F)
write.table(t(consensusMatrix(seq2[strand=="-"])[1:4,]),"210329_torimochi03_variant_table_antisense.txt",sep="\t",quote=F)

####Open R to extract sequence information from bam file for Ovary data####
R
library(Biostrings)
library(Rsamtools)

bam <- scanBam("170124_OV1_MLVminus_torimochi03_bt.bam")
#> names(bam[[1]])
# [1] "qname"  "flag"   "rname"  "strand" "pos"    "qwidth" "mapq"   "cigar" 
# [9] "mrnm"   "mpos"   "isize"  "seq"    "qual"  
chr3 <- bam[[1]]$rname == "chr03_newins"
chr3[is.na(chr3)] <- F
#head(bam[[1]]$pos[chr3])

pos <- bam[[1]]$pos[chr3]
qname <- bam[[1]]$qname[chr3]
qwidth <- bam[[1]]$qwidth[chr3]
cigar <- bam[[1]]$cigar[chr3]
seq <- bam[[1]]$seq[chr3]
qual <- bam[[1]]$qual[chr3]
strand <- bam[[1]]$strand[chr3]


seq2 <- seq
for(i in 1:8725){

tag <- pos ==i
ins <- paste(rep("N",i-1),collapse="")

seq2[tag] <- paste0(ins,seq[tag])

cat(i)
}

write.table(t(consensusMatrix(seq2[strand=="+"])[1:4,]),"221117_torimochi03_variant_table_OVpiRNA_sense.txt",sep="\t",quote=F)
write.table(t(consensusMatrix(seq2[strand=="-"])[1:4,]),"221117_torimochi03_variant_table_OVpiRNA_antisense.txt",sep="\t",quote=F)



###RNA sequence library were divided into 33 nucleotides each###
#RNA-seq of BmN4
gunzip 171128_1_pIZ_R1.fastq.gz  
gunzip 171128_1_pIZ_R2.fastq.gz

seqkit subseq -r 1:33 171128_1_pIZ_R1.fastq > 171128_1_pIZ_R1_1st.fastq
seqkit subseq -r 34:66 171128_1_pIZ_R1.fastq > 171128_1_pIZ_R1_2nd.fastq
seqkit subseq -r 67:99 171128_1_pIZ_R1.fastq > 171128_1_pIZ_R1_3rd.fastq
seqkit subseq -r 1:33 171128_1_pIZ_R2.fastq > 171128_1_pIZ_R2_1st.fastq
seqkit subseq -r 34:66 171128_1_pIZ_R2.fastq > 171128_1_pIZ_R2_2nd.fastq
seqkit subseq -r 67:99 171128_1_pIZ_R2.fastq > 171128_1_pIZ_R2_3rd.fastq

cat 171128_1_pIZ_R1_1st.fastq 171128_1_pIZ_R1_2nd.fastq 171128_1_pIZ_R1_3rd.fastq > 171128_1_pIZ_33cut_R1.fastq
cat 171128_1_pIZ_R2_1st.fastq 171128_1_pIZ_R2_2nd.fastq 171128_1_pIZ_R2_3rd.fastq > 171128_1_pIZ_33cut_R2.fastq
seqkit rename 171128_1_pIZ_33cut_R1.fastq -n > 171128_1_pIZ_33cut_R1_rename.fastq
seqkit rename 171128_1_pIZ_33cut_R2.fastq -n > 171128_1_pIZ_33cut_R2_rename.fastq
pigz 171128_1_pIZ_33cut_R1_rename.fastq
pigz 171128_1_pIZ_33cut_R2_rename.fastq

#RNA-seq of silkworm ovary
unpigz DRR186503_NIAS_OV_R1.fastq.gz  
unpigz DRR186503_NIAS_OV_R2.fastq.gz

seqkit subseq -r 1:33 DRR186503_NIAS_OV_R1.fastq > DRR186503_NIAS_OV_R1_1st.fastq
seqkit subseq -r 34:66 DRR186503_NIAS_OV_R1.fastq > DRR186503_NIAS_OV_R1_2nd.fastq
seqkit subseq -r 67:99 DRR186503_NIAS_OV_R1.fastq > DRR186503_NIAS_OV_R1_3rd.fastq
seqkit subseq -r 1:33 DRR186503_NIAS_OV_R2.fastq > DRR186503_NIAS_OV_R2_1st.fastq
seqkit subseq -r 34:66 DRR186503_NIAS_OV_R2.fastq > DRR186503_NIAS_OV_R2_2nd.fastq
seqkit subseq -r 67:99 DRR186503_NIAS_OV_R2.fastq > DRR186503_NIAS_OV_R2_3rd.fastq

cat DRR186503_NIAS_OV_R1_1st.fastq DRR186503_NIAS_OV_R1_2nd.fastq DRR186503_NIAS_OV_R1_3rd.fastq > DRR186503_NIAS_OV_33cut_R1.fastq
cat DRR186503_NIAS_OV_R2_1st.fastq DRR186503_NIAS_OV_R2_2nd.fastq DRR186503_NIAS_OV_R2_3rd.fastq > DRR186503_NIAS_OV_33cut_R2.fastq
seqkit rename DRR186503_NIAS_OV_33cut_R1.fastq -n > DRR186503_NIAS_OV_33cut_R1_rename.fastq
seqkit rename DRR186503_NIAS_OV_33cut_R2.fastq -n > DRR186503_NIAS_OV_33cut_R2_rename.fastq
pigz DRR186503_NIAS_OV_33cut_R1_rename.fastq
pigz DRR186503_NIAS_OV_33cut_R2_rename.fastq


#Mapping by bowtie
bowtie-build torimochi03.fasta torimochi03

QQ="torimochi03"
for Q in ${QQ};do
NN="DRR186503_NIAS_OV_33cut_R1_rename DRR186503_NIAS_OV_33cut_R2_rename 171128_1_pIZ_33cut_R1_rename 171128_1_pIZ_33cut_R2_rename"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 3 -t --sam ${Q} -fq /home/kshoji/Gawain/NGSdata/${N}.fastq.gz  > ${N}_${Q}_bt.sam )  
	samtools view -@ 20 -bS ${N}_${Q}_bt.sam > ${N}_${Q}_bt.bam
bamToBed -i ${N}_${Q}_bt.bam > ${N}_${Q}_bt.bed
rm ${N}_${Q}_bt.sam

done
done


####Open R to extract sequence information from bam file for RNA-seq data####
R
library(Biostrings)
library(Rsamtools)

names <- c("DRR186503_NIAS_OV_33cut_R1_rename","DRR186503_NIAS_OV_33cut_R2_rename","171128_1_pIZ_33cut_R1_rename","171128_1_pIZ_33cut_R2_rename")

for(j in 1:length(names)){

bam <- scanBam(paste0(names[j],"_torimochi03_bt.bam"))
#> names(bam[[1]])
# [1] "qname"  "flag"   "rname"  "strand" "pos"    "qwidth" "mapq"   "cigar" 
# [9] "mrnm"   "mpos"   "isize"  "seq"    "qual"  
chr3 <- bam[[1]]$rname == "chr03_newins"
chr3[is.na(chr3)] <- F
#head(bam[[1]]$pos[chr3])

pos <- bam[[1]]$pos[chr3]
qname <- bam[[1]]$qname[chr3]
qwidth <- bam[[1]]$qwidth[chr3]
cigar <- bam[[1]]$cigar[chr3]
seq <- bam[[1]]$seq[chr3]
qual <- bam[[1]]$qual[chr3]
strand <- bam[[1]]$strand[chr3]


seq2 <- seq
for(i in 1:8725){

tag <- pos ==i
ins <- paste(rep("N",i-1),collapse="")

seq2[tag] <- paste0(ins,seq[tag])

cat(i)
}

write.table(t(consensusMatrix(seq2[strand=="+"])[1:4,]),paste0("221117_torimochi03_variant_table_",names[j],"_sense.txt"),sep="\t",quote=F)
write.table(t(consensusMatrix(seq2[strand=="-"])[1:4,]),paste0("221117_torimochi03_variant_table_",names[j],"_antisense.txt"),sep="\t",quote=F)
}

####Open R to create a graphs####
library(ggplot2)
library(ggthemes)
library(Biostrings)
library(ggsci)
library(RColorBrewer)
strain<- read.table("220209_torimochi_aln.vcf")
site<-c(1769,1858,1961,2131,2133,2338,2417,2587,2590,2621,2800,2861,2904,3042,3247,3376,
        3501,3654,3885,3930,4083,4086,4101,4287,4591,4597,4650,4707,4774,4846,4857,4980,
        5001,5004,5046,5112,5250,5562,5682,5688,5703,5898,5943,6108,6231,6273,6306,6461,
        6561,6624,6645,6747,7030,7033,7123,7405,8062,8085,8221,8244,8270) #SNPs sites


anti <-read.table("210329_torimochi03_variant_table_antisense.txt")
sense <-read.table("210329_torimochi03_variant_table_sense.txt")


anti2 <- sweep(anti,1,apply(anti,1,sum),"/")
sense2 <- sweep(sense,1,apply(sense,1,sum),"/")
anti3 <- anti2[site,]
rownames(anti3) <- site
sense3 <- sense2[site,]
antiB <- data.frame("nucleotide"=c(rep("A",nrow(anti3)),rep("C",nrow(anti3)),rep("G",nrow(anti3)),rep("T",nrow(anti3))),
                    "position"=rep(1:nrow(anti3),4),
                    "ratio"=c(anti3[,1],anti3[,2],anti3[,3],anti3[,4]))
senseB <- data.frame("nucleotide"=c(rep("A",nrow(sense3)),rep("C",nrow(sense3)),rep("G",nrow(sense3)),rep("T",nrow(sense3))),
                    "position"=rep(1:nrow(sense3),4),
                    "ratio"=c(sense3[,1],sense3[,2],sense3[,3],sense3[,4]))



senseBm <- cbind(senseB,RNA="piRNA sense")
antiBm <- cbind(antiB,RNA="piRNA antisense")

BOX <- rbind(senseBm,antiBm,senseRBm,antiRBm,Input1Bm,H27Bm)



g <- ggplot(senseB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Sense piRNA",x="SNPs position",y="Ratio")+scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "220513_sense_piRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)

g <- ggplot(antiB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Antisense piRNA",x="SNPs position",y="Ratio") +scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "220513_antisense_piRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)



senseRA <- read.table("221117_torimochi03_variant_table_171128_1_pIZ_33cut_R2_rename_sense.txt")
antiRA <- read.table("221117_torimochi03_variant_table_171128_1_pIZ_33cut_R2_rename_antisense.txt")
senseRB <- read.table("221117_torimochi03_variant_table_171128_1_pIZ_33cut_R1_rename_sense.txt")
antiRB <- read.table("221117_torimochi03_variant_table_171128_1_pIZ_33cut_R1_rename_antisense.txt")

senseR <- senseRA + antiRB
antiR <- antiRA + senseRB

antiR2 <- sweep(antiR,1,apply(antiR,1,sum),"/")
senseR2 <- sweep(senseR,1,apply(senseR,1,sum),"/")
antiR3 <- antiR2[site,]
rownames(antiR3) <- site
senseR3 <- senseR2[site,]
antiRB <- data.frame("nucleotide"=c(rep("A",nrow(antiR3)),rep("C",nrow(antiR3)),rep("G",nrow(antiR3)),rep("T",nrow(antiR3))),
                     "position"=rep(1:nrow(antiR3),4),
                     "ratio"=c(antiR3[,1],antiR3[,2],antiR3[,3],antiR3[,4]))
senseRB <- data.frame("nucleotide"=c(rep("A",nrow(senseR3)),rep("C",nrow(senseR3)),rep("G",nrow(senseR3)),rep("T",nrow(senseR3))),
                      "position"=rep(1:nrow(senseR3),4),
                      "ratio"=c(senseR3[,1],senseR3[,2],senseR3[,3],senseR3[,4]))



g <- ggplot(senseRB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Sense mRNA",x="SNPs position",y="Ratio")+scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "221117_sense_mRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)

g <- ggplot(antiRB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Antisense mRNA",x="SNPs position",y="Ratio") +scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "221117_antisense_mRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)



cbind(apply(senseR[site,],1,sum),
      apply(antiR[site,],1,sum))


antiOV <-read.table("221117_torimochi03_variant_table_OVpiRNA_antisense.txt")
senseOV <-read.table("221117_torimochi03_variant_table_OVpiRNA_sense.txt")


antiOV2 <- sweep(antiOV,1,apply(antiOV,1,sum),"/")
senseOV2 <- sweep(senseOV,1,apply(senseOV,1,sum),"/")
antiOV3 <- antiOV2[site,]
rownames(antiOV3) <- site
senseOV3 <- senseOV2[site,]
antiOVB <- data.frame("nucleotide"=c(rep("A",nrow(antiOV3)),rep("C",nrow(antiOV3)),rep("G",nrow(antiOV3)),rep("T",nrow(antiOV3))),
                    "position"=rep(1:nrow(antiOV3),4),
                    "ratio"=c(antiOV3[,1],antiOV3[,2],antiOV3[,3],antiOV3[,4]))
senseOVB <- data.frame("nucleotide"=c(rep("A",nrow(senseOV3)),rep("C",nrow(senseOV3)),rep("G",nrow(senseOV3)),rep("T",nrow(senseOV3))),
                     "position"=rep(1:nrow(senseOV3),4),
                     "ratio"=c(senseOV3[,1],senseOV3[,2],senseOV3[,3],senseOV3[,4]))



g <- ggplot(senseOVB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="sense piRNA",x="SNPs position")
plot(g)
ggsave(file = "221117_sense_OV_piRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)

g <- ggplot(antiOVB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="antisense piRNA",x="SNPs position")
plot(g)
ggsave(file = "221117_antisense_OV_piRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)


cbind(apply(senseOV[site,],1,sum),
      apply(antiOV[site,],1,sum))


senseOVRA <- read.table("221117_torimochi03_variant_table_DRR186503_NIAS_OV_33cut_R2_rename_sense.txt")
antiOVRA <- read.table("221117_torimochi03_variant_table_DRR186503_NIAS_OV_33cut_R2_rename_antisense.txt")
senseOVRB <- read.table("221117_torimochi03_variant_table_DRR186503_NIAS_OV_33cut_R1_rename_sense.txt")
antiOVRB <- read.table("221117_torimochi03_variant_table_DRR186503_NIAS_OV_33cut_R1_rename_antisense.txt")

senseOVR <- rbind(senseOVRA,senseOVRA[1:3,]) + antiOVRB
antiOVR <- antiOVRA + rbind(senseOVRB,senseOVRB[1:3,])

antiOVR2 <- sweep(antiOVR,1,apply(antiOVR,1,sum),"/")
senseOVR2 <- sweep(senseOVR,1,apply(senseOVR,1,sum),"/")
antiOVR3 <- antiOVR2[site,]
rownames(antiOVR3) <- site
senseOVR3 <- senseOVR2[site,]
antiOVR3[is.nan(as.matrix(antiOVR3))] <- 0
senseOVR3[is.nan(as.matrix(senseOVR3))] <- 0
antiOVRB <- data.frame("nucleotide"=c(rep("A",nrow(antiOVR3)),rep("C",nrow(antiOVR3)),rep("G",nrow(antiOVR3)),rep("T",nrow(antiOVR3))),
                     "position"=rep(1:nrow(antiOVR3),4),
                     "ratio"=c(antiOVR3[,1],antiOVR3[,2],antiOVR3[,3],antiOVR3[,4]))
senseOVRB <- data.frame("nucleotide"=c(rep("A",nrow(senseOVR3)),rep("C",nrow(senseOVR3)),rep("G",nrow(senseOVR3)),rep("T",nrow(senseOVR3))),
                      "position"=rep(1:nrow(senseOVR3),4),
                      "ratio"=c(senseOVR3[,1],senseOVR3[,2],senseOVR3[,3],senseOVR3[,4]))



g <- ggplot(senseOVRB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Sense mRNA",x="SNPs position",y="Ratio")+scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "221117_sense_OV_mRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)

g <- ggplot(antiOVRB, aes(x = position, y = ratio, fill = nucleotide))
g <- g + geom_bar(stat = "identity", position = "fill")+ theme_bw(base_size = 15, base_family = "Helvetica")
g <- g + scale_fill_brewer(palette = "Set3") + labs(title="Antisense mRNA",x="SNPs position",y="Ratio") +scale_x_continuous(breaks = c(1,10,20,30,40,50,60),labels=c(1,10,20,30,40,50,60))
plot(g)
ggsave(file = "221117_antisense_OV_mRNA_SNPs.pdf", plot = g, width = 11, height = 2.5)



cbind(apply(senseOVR[site,],1,sum),
      apply(antiOVR[site,],1,sum))

cbind(apply(sense[site,],1,sum),
apply(anti[site,],1,sum),
apply(senseR[site,],1,sum),
apply(antiR[site,],1,sum))


########################################
## Fig. S3
########################################

#Mapping by bowtie
Rscript --slave --vanilla /home/kshoji/Gawain/scripts/fasta2bed.R 210824_torimochi_chr13_GFPnotoko
bowtie-build toricore_pm10kb.fas toricore_pm10kb

#V2
QQ="220209_newins_around toricore_pm10kb"
for Q in ${QQ};do
NN="181220_P1_Naïve_Total_NaIO4m 170124_OV1_MLVminus"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 2 -t --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${N}_trim.fasta.gz  > ${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${N}_${Q}.sam > ${N}_${Q}.bam
bamToBed -i ${N}_${Q}.bam > ${N}_${Q}.bed
rm ${N}_${Q}.sam
rm ${N}_${Q}.bam
	awk '$3-$2>22' ${N}_${Q}.bed > ${N}_${Q}_piRNA.bed

coverageBed -b ${N}_${Q}_piRNA.bed -a ${Q}.bed -s -d> ${N}_${Q}_plus.txt
coverageBed -b ${N}_${Q}_piRNA.bed -a ${Q}.bed -S -d> ${N}_${Q}_minus.txt
done
done
done


#V0 (Because the torimochi sequences are very similar to each other)
QQ="220209_torimochi_newins "
for Q in ${QQ};do
NN="181220_P1_Naïve_Total_NaIO4m 170124_OV1_MLVminus"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 0 -t --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${N}_trim.fasta.gz  > ${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${N}_${Q}.sam > ${N}_${Q}.bam
bamToBed -i ${N}_${Q}.bam > ${N}_${Q}.bed
	awk '$3-$2>22' ${N}_${Q}.bed > ${N}_${Q}_piRNA.bed

rm ${N}_${Q}.sam
rm ${N}_${Q}.bam
coverageBed -b ${N}_${Q}_piRNA.bed -a ${Q}.bed -s -d> ${N}_${Q}_plus.txt
coverageBed -b ${N}_${Q}_piRNA.bed -a ${Q}.bed -S -d> ${N}_${Q}_minus.txt
done
done
done

#Mapping by bowtie
#To calculate total mapped reads
bowtie-build -f /home/kshoji/Gawain/REFdata/Bomo_genome_assembly.fa Bomo_genome

#V2
QQ="Bomo_genome"
for Q in ${QQ};do
PP="181220_"
for P in ${PP};do
NN="P1_Naïve_Total_NaIO4m"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 2 -t -m 1 --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${P}${N}_trim.fasta.gz  > ${P}${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${P}${N}_${Q}.sam > ${P}${N}_${Q}.bam
bamToBed -i ${P}${N}_${Q}.bam > ${P}${N}_${Q}.bed
rm ${P}${N}_${Q}.sam
rm ${P}${N}_${Q}.bam
done
done
done

QQ="Bomo_genome"
for Q in ${QQ};do
PP="170124_"
for P in ${PP};do
NN="OV1_MLVminus"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 2 -t -m 1 --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${P}${N}_trim2.fasta.gz  > ${P}${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${P}${N}_${Q}.sam > ${P}${N}_${Q}.bam
bamToBed -i ${P}${N}_${Q}.bam > ${P}${N}_${Q}.bed
rm ${P}${N}_${Q}.sam
rm ${P}${N}_${Q}.bam
done
done


QQ="Bomo_genome"
for Q in ${QQ};do
NN="171128_1_pIZ DRR186503_NIAS_OV"
for N in  ${NN}; do
        echo $N
hisat2 -x ${Q} -1 /home/kshoji/Gawain/NGSdata/${N}_R1.fastq.gz  -2 /home/kshoji/Gawain/NGSdata/${N}_R2.fastq.gz -k 3 -p 20 -S ${N}_${Q}_HS2.sam
samtools view -@ 20 -bS ${N}_${Q}_HS2.sam > ${N}_${Q}_HS2.bam
bamToBed -bed12 -i ${N}_${Q}_HS2.bam > ${N}_${Q}_HS2.bed
 rm ${N}_${Q}_HS2.sam
done
done



#BmN4 18169997
#OV 86281176


########################################
## Fig. S3A–H
########################################
R
library(ggplot2)
totalo <- 134261868
totalq <- 43864953

tovp <- read.table("170124_OV1_MLVminus_220209_torimochi_newins_plus.txt")
tovm <- read.table("170124_OV1_MLVminus_220209_torimochi_newins_minus.txt")
tBmQp <- read.table("181220_P1_Naïve_Total_NaIO4m_220209_torimochi_newins_plus.txt")
tBmQm <- read.table("181220_P1_Naïve_Total_NaIO4m_220209_torimochi_newins_minus.txt")
aovp <- read.table("170124_OV1_MLVminus_220209_newins_around_plus.txt")
aovm <- read.table("170124_OV1_MLVminus_220209_newins_around_minus.txt")
aBmQp <- read.table("181220_P1_Naïve_Total_NaIO4m_220209_newins_around_plus.txt")
aBmQm <- read.table("181220_P1_Naïve_Total_NaIO4m_220209_newins_around_minus.txt")

names <- c("chr03_newins","chr06_newins","chr06_2_newins","chr11_newins","chr13_newins","chr17_newins","chr21_newins","chr23_newins")
titles <- c("chr03","chr06","chr06_2","chr11","chr13","chr17","chr21","chr23")
for(i in 1:8){
tag <- names[i]
if(i ==3){
dwposi <- grep(paste0("Bomo_Chr",as.numeric(substr(tag,4,5)),"_2_newins_dw"),aBmQp[,1])
upposi <- grep(paste0("Bomo_Chr",as.numeric(substr(tag,4,5)),"_2_newins_up"),aBmQp[,1])
}else{
dwposi <- grep(paste0("Bomo_Chr",as.numeric(substr(tag,4,5)),"_newins_dw"),aBmQp[,1])
upposi <- grep(paste0("Bomo_Chr",as.numeric(substr(tag,4,5)),"_newins_up"),aBmQp[,1])
}
Y1 <- c(aBmQp[upposi,8],tBmQp[tBmQp[,1]==tag,8],aBmQp[dwposi,8])/totalq*1000000
Y2 <- c(-aBmQm[upposi,8],-tBmQm[tBmQm[,1]==tag,8],-aBmQm[dwposi,8])/totalq*1000000
Y3 <- c(aovp[upposi,8],tovp[tovp[,1]==tag,8],aovp[dwposi,8])/totalo*1000000
Y4 <- c(-aovm[upposi,8],-tovm[tovm[,1]==tag,8],-aovm[dwposi,8])/totalo*1000000
len <- length(Y1)


DATA <- data.frame(c(rep("BmN4",len),rep("BmN4",len),rep("Ovary",len),rep("Ovary",len)),
      c(1:len,1:len,1:len,1:len),
      c(Y1,Y2,Y3,Y4))
	  
DATA[,1] <- factor(DATA[,1],levels=c("BmN4","Ovary"))
colnames(DATA) <- c("PIWI","position","RPM")
p0 <- ggplot(data = DATA, mapping = aes(x = position, y = RPM))
p0 <- p0 + facet_grid(PIWI ~ .)+ ggtitle(titles[i])
p0 <- p0 + geom_bar(stat = "identity", position = "dodge")
p0 <- p0 + theme_bw(base_size = 15, base_family = "Helvetica")
p0 <- p0 + geom_vline(xintercept=c(5000+0.5,len-5000+0.5),colour="grey")
ggsave(file = paste0("220222_",tag,"_piRNA_profile.png"), plot = p0, dpi = 200, width = 6, height = 3.5)

}


########################################
## Fig. S3J
########################################
#Svim (align Nanopore reads with ngmlr, then call SVs) for EGFP repressed cell line
#to determine on which chromosome the EGFP cassette is inserted in the torimochi.
svim reads --nanopore line11_svim /home/kshoji/Gawain/NGSdata/201105_11line_minion_cat.fastq /home/kshoji/Perceval/torimochi/Bomo_genome_assembly_pIGA3.fa       # align Nanopore reads with ngmlr, then call SVs

#see and extract from candidates_breakends.bed of svim output

 V1   V2   V3                           V4 V5
22618 pIGA3 8300 8301  bnd;<Bomo_Chr11:6325669;.;.  1
1792  pIGA3 2370 2371 bnd;<Bomo_Chr12:16569282;.;.  1
12952 pIGA3 8300 8301 bnd;<Bomo_Chr12:16569885;.;.  1
                                                                                                 V6
22618   [Bomo_Chr11:6325669-6325670|pIGA3:8300-8301|BND;suppl|63775454-d8e1-43b2-ae3c-ffcfbc8b0357]
1792  [Bomo_Chr12:16569282-16569283|pIGA3:2370-2371|BND;suppl|7bd7fa45-111d-4271-bfc3-bfedef929edb]
12952 [Bomo_Chr12:16569885-16569886|pIGA3:8300-8301|BND;suppl|67da0424-e19d-4d7e-9a46-f089aa2a0a93]

#get the sequences
grep "63775454-d8e1-43b2-ae3c-ffcfbc8b0357" -A2 201105_11line_minion_cat.fastq
grep "7bd7fa45-111d-4271-bfc3-bfedef929edb" -A2 201105_11line_minion_cat.fastq
grep "67da0424-e19d-4d7e-9a46-f089aa2a0a93" -A2 201105_11line_minion_cat.fastq

#The sequences which contain EGFP casette
@63775454-d8e1-43b2-ae3c-ffcfbc8b0357 runid=84b250a8bf9dd6cb08d0e093a8666cf11c5b0715 read=34306 ch=198 start_time=2020-10-29T15:48:09Z flow_cell_id=FAM93798 protocol_group_id=11line_genome2 sample_id=11line_genome2
GTTGTACTTCGTTCGAATCATCGATGATTATCGTTTTCGCATTTATCGTGAAACGCTTTCGTTTTCGTGCGCCACCGCTACTGCGTAATCTTTAAGTATAGCGTTAATCAGATCTTATTACCTCGCGATTGGCTTATTGTATGCACTTTAATCAAGCCAAATTGCGAAAATATACCTGTTTTTAGACAATAAGAAGAAACGAACTTCCGATGATGGATTGTTTACAGAAAATTGCATTCCGCGTTTTAAATAAATTGTAATAATTTCATGTAACATCTAAGGTTTATAATAATATATTATGATCCTCTAATAATGACTCGTCAGAGAACGCGCATAAATTAATAAAAAAAAAAATATATAATATATTATATTTGACCTCATAATTTTCTGAATACCGCCTTCCCTATATTATGGTTTTCAACATTTACGTACTTTGTTATTGAAGCGTGCTATGGCAGGATTCACTACGGCCAGATTTTTAAAAATACAAATAAAGTTATCTGAAGGTCCGACATTGATCACGCGCACTGATTTAGGAGGATAGGAAGACTTGACCGCTCGGGTCGAAGATTGAATCGAGGTTAATACTCGAGGTCGAAAGATTGTACAAGACTGTCCGTTTATCGGGCAGTCAGAACAGGAGAAACTCAGGAATGCTGATCGTGCAGCTTAGTTGGGGCTGTCCAGCTTCATCGTGTTCATACTAGGTTATATAACACCTCCCCATGGGAAAATAAACTTTGGGGGCTTCAGTCTCTAGTTTGTGATTTGAAATGATACGTGGATCTGGAAGAGGATTTAGTCTGATTTAGGTAAGGGATTACTATTATATAGGTTAGTGAAGAGAAGGCTTTAGAAAGTCTGGCGTGGTTCTAGAGTTACGGCAGGTCTTGTTGACGAATTAAATTCTCCTGGATTATGATGGGTTGTTCTGGATTGTTTACGATGATCCATTGGGATCTCTGTGCGATCGTGAGCGTCGTTGGGCTTGTTACCCATATCGCGTAGTTTTAAGATACAATAGTGGTGTGAAATAACACCAAGGAAGGAATATGTGCGTCATATTTTGTAAAATGATTAGGATGTTCGATCTTTATAAGTTCTGGAATTAAGTTTGGTGTTTTCTAATAGATGATTAAGTAAATTCTAGGTCAAGTTGGTTTAGTTTTAATGTGGGAGCTGTTATTCTCGGCTTCTTTGAATTTAGCAAAGTTACAACATGAATCATTTAATATGTTTAAATCTAACTTAATAGTAGGATGACTTATATTAAAAGGACGTAGGAGTAGAGGAAATAGTCGGGTATCTTTACGAAAACCTTTACATGTTATCCGGGACCAGTTACGATTCCCGTGCCTGATATAATATGGTCTTCCTCGGTTCACTTACAATCGATTGACAGTTTACTTGGTTTGGATTGAACAAATATCCTTCTTATTATGAGTGGTTCCCACACATCTATGATTTAAATGGAATGTTATAGTTTCACCTGAGTTGGCAGGTGTGTTAATAGCTTTAAAAGCCTTAATTCTTTCACAGGATGGATTGGCGTTTGTAGAAAGTACACAATAATTGCAAATGTGTCTTCATAATAGTGATTGATTTATTGGCTTAGGGATCTTAGTACCACCTCAGGTTTTATCTGCCACCTGCGCTTTCAGGTACTTCTCTGTTCGGAATTACGATTGCTGAAGGAGTTTATGTTTATATGATTCTTAAATTTACAGGTAATGGAGATTAAAGGGTATACATTGAATTCTTGAGGTTCTGGGATTTGTAAACGAACCAGTCTTAACATAATTTAAAATACTTTACAACATTATTTCAATAAAAGTATGTATGTGTTTAAATCGAGACTCGTGGCTAATTCTAAGTCGCTAGGTAAGTGTCGGTGATTCTCAATGAAGTTCTTGGTGTAAATTGAGACGGCGTTAGTGAATGGATGTATAATATTTAAATTTACTAAAGATACAAATTTATATCTTCCAATTGGAAGGACAAACACAAGGGCAGTTTCTGGGTGCTATTACGATGTGAGATGAAGACAGTGCCATATTACTAGATGTTCTGATGGTTTCTGGTGGTGAAACTTTTCGATAGCCACGTTGAGTTTTCTTCATTTTCTTTTGCCAGCATTCGAAAGTTTCGATGTTTTCGTTTTATAGTTGGTTGGTTACAGAATTTGGTACAACTTAGTTAACCCTAGAAAGATAATCTGTTAGCAATAACGTGCGTTAAAAATAATCATGCGTAAAATTGACGCATGTGTTTTTGCTCCGGTCTATTATATCGAGGTTTTATTTATAGCCCGAATAGATAAGTTTTATTATATTTACACTTACATATAATAATAAGAATTCAACAAACAATTTATTTATGTTTGTTCTTATTAAAAAAACAAAAACTCAAAAATTCTTCTATAAAGTAACAAAACTTTTAAACATTCTGTCTCTTTTACAAAAATAAACTTATTTTGTACTTTAAAAACAGTCATGTTATTATAAATAATATTAAAACCACTTCTAAAATAAATTATACTTATTAGTCAGTCAGAAACAGCTTTGGCACATATCAATATTCATACTCCTCGACAGCAAATAACTTTTTGCATTTTTTGCCCGATACGTTTGCCCTTTCGCCTTATTTTAAAGGCAGTAAATTACCAGTAAATACGTTTTTTCATTACTAGCTCTTCCATTTTGTCATCTGATATGCCAGAGCACTTCATTTGTATCTTCAAGGAATTATAACAAATATCTCTTCAAAGGCTAGGAGCTTCAACAACACACATAAACGATGACGTCAGGCTCATGCTTATAAAGTTTCTCCATAATTTTTGCGACTTTGAACCTATTTTCTCCTTACTAGTATTATGGCTTGCCTCTGTAAAGAATTTATGCAGGCAATGTTTATCTGTTCAATACATCATACCACTAAACCCTACCTCTTCAATCTTTCCCTACCGGGTCATCACCAGAACACATTTGGTCTAGCATTCTCCACTCCGCCCTTTAGTTTGATTATAATACATAACCATTTACGGTTTACCAGTTACCGTTGTAGTAAAGCCTCTATCTGGATGTGCTTAAACTACTCTATCTTAGCTAGCTGGTTTATATGGGACAGTAAGGGTCGTCAAAAACAAAACATCGATGTTCCCACTGGCCTGGGCGACTGTTTTTCAGTACTTCCAGTATAACGTTTGTTTGATCACGGTTCCCCCAATGGTTCCTCCAAAAAACCTCTCACTACTTCTGGAATAGCTCTTAGAAATGAAGGCGACCTCTCTGACTCTATCTAATAAAAAAAGTGGTCAGCCATGGAATGAGAGAATATGGGCAGAACTGGGCCGGAGTTAGAGGCCGAGATGGGCGGAGTTAGGGGCGGGACTATGGTTGCTGATAAGTGAGATGCATGCTTTGCGTACTTCTGCCTGCTGGGGAGCCTGGGGACTTTCCACCTGGTTGTGCAATATTAAGTACCCTTTGCGCCACTTCCCTTGCCTGCTGGGAGCCTGGGGACTTTCCACACCTAGCAGCATTCACAGCTGGTTCTTTCCTTATCAGGACTCTCCTTTTTCCAATATTATTGAGAAGCATTTATCAGGGTTGTGTCTCATGAGCGGATACATATTTGGTCTTATTTAGAAAAATAAGCAAATAGGGGTTCGCATTTCCCCGAAAGTGCCACCTGGCGCGCCCTGTAGCACGGCGCATTAGCGCGGGTGTGTCGTTCGCACCCAACGTGGCCGCTACGCTTACCCGCGCCGCCCGCTCCCTTTCCGCTTTCTTCTTCCTTTCTCTTACGTTCTTAGAAGCTTTCCCCGTCAAGCACTAATCGGGAGGCTCTTGGGATTCAGTTTGGTACCCATCGACCCAAAAAACGATTAGGGTGATGGTTTCGTAGTAGGGCCATCGCCCACAATAAATGATTTCGCCCTTTGACGTTGGGAGTCTACGTTCTTTAATAGTGGACTCTTGTTCCAAACTCAAACATCAACCTATCTCCGGTCTATTCTTTTGATTTATAAGGTTTTTCGTTTCGGCCTAATGGTTAAAAATGAGCTGATTAACAAAAATTGCACAATTTTAACAAATCTTCAACACCCTAACATTTACGCCTTAGACCCATTGATGAGTTTGGACAATACAACTAGAATGCAGTGAAAAAATACTTTATTTGTGAAATTTGTGATGCTATTGCTTTATTTTGTAGCCATTATAAGCTGCAATAAACAAGTTAACCTTTTAACAATTGCATTCATTTTATGTTTCAGGTTCAGGGAGAGTGCCAGGAGGTTCTGGCTTATTAAAACACTCTACAAATGTGCTGATTATGATCTAAAGTGTGGCCGCTTTACTTGTACAGCTCGTCATGCCGAGTGATCCAGCGTGGTCTGACTTCAACAGGACCATGTGATCGCGCTTCTCGTTGGGGTCTTTTAGCCTCCAAAGCCAGACTGTTTATGATGTAGTGCTGTCGAACGCGCACGAGGCCGTCGCCGATAGGGGTGTTCTGCTGGTAGTGGTCGGCAGGCTGCTACGCTGCCGTCTCGATGTTAATGGCGGATCTTGAAGTCCTGATGCCGTTCTTCGCTTGTCGACCCGCGATAGACGTTGTGGCTGTTGGTTGTACTCAGCATTGCCCCAGGATGTTGCCGTCGCTCGCCCGGTCGTACGCTAGCTCAGTCTGCGGTTCACCAGGGTGGCTCGCCCTCGGAACTTCACCTGTGGCTTGGGTCTTATCTGATTTGCCGTCGTCATGAAGAAGATGGTGCGGCACCTGGACGCCAGCCTTCCAGGCATGGCGGGCTGAAAGAGTCGTGCTGCTTCATGTGGTCGGGGTAGCGGCGCTGAAGCACTGCACGCCGCTAAGGTCAGGGTGATCACGAGGGTGGGCCAAGGGCTTGCGAGCAGCTTGCCGTGGTTACGGTGAACTGAGGTCAGCTTGCCGTAGGTGGCATCGCCACTCGCCCTCACCGGACACGCTGAACTTGTGGCCGTTTACGTCGCCGTCAGAACTCAACCAGGATGCAGGCACCCACGGTGAACAACTCTCGCCCTTGCTCACCATGGTGGCGACCGGTGATCTTGAACTAATCTCAGAAAAACACTGTTCAAACTACATTCTCATTCCATACATTATACTAAATCAACAACAAATTTATTGCGATCCATCTATTTAATTGATTAAAAGCTTCCTCAAATTCATAATTCACTGTTCCAATTTCTGTTTCATAATTAGTCGTGCGGTGAATACTTTGAAATACTTACGTCCAATAAACTTATTTCTTATTTGTAGTGTTTTACTAACATCTGCTAGTACCTTAATTCAAGAAAACTGTTTTTATAAAGAATTTCACTTCTACTCGTTATGCAACAATTATGTAACGTAACACGTTATCGTATTAGCGTATTATTAAAAAAAAACACTCAAACATATGGCATATACTTAAAGGTGAGGACGAGAACCTTCGAGAAATTCAAGTACAAATAAATAAATGTGTTTTTTCTTTGCCAATTTTAAATTAAAACACATAGTATTATTAAATAGAAGAGTGACAATTGGCGATGCGAATGCGCACTGTTCGAGCACACCTTAGTAATGAGCCGACTCAGTAGGGATAAGCTAAAAGACATTTCTCTGCAATTTACAGTATCAGCTCCAATTGTTTTCCATAATCTGCGGGCTGACTCAGTTTTGTCACCACTATATGATAGCACGATAACTGACTTTCAAGATCTATAGATCTTACAGGAAGTGGGAGAATGAGCTGTTAGCCTCATGTTTGGTTTGCTTTGTTAAATTCTGTAATTATCCAACTGTGAAACATTATCATAAGCAGCTAAGAGCCTTCAGTAAAGAGCAGGCATTTATCATCCCACCCCACCCCACCCCCGTAGCTCAATCCTTCCATTCAAAATGTAGGTACTCTGTTCTACCCCTTATAACAAAGTATGACAGGAAAACTTCCATTTAGTGGACATCTTTATTGTTTAATAGATCATCAATTTCTGCATCCCGGGATCTGATATCATCGATACCATGGTCGTGCGCTCCTTTCGGTCGGGCGCGCTGCGGGGTCGTTGATCAGGGCGGGCGTCAGGCAAGCACGGAATTCGCCTTCGGGTGCGGTCCTTCAGGCACCTCGACGTCGGCATGGTGACGGTGAAGCCGAACCGCTCGTAGAAGGAAGTTACCGGGCGCAGGAGGTCGAAGGCGGGCACCCGGCGCGCTCGGCCGCCTCCACTCCAGAACGGCACTACCCAGGAATATTATGCCCTAGTGGTCGGGCGAGACGCCGACGATGGCCAGGAACCACACCGGCTCCTTGGGCGGTGCGGCGCCAGGAGGCCTTCCATCTGTTGCTGCAGCCCAGCAGAACCGCTCGGCTCCGGCCACTGCGGGCCGATCTCGGCGAACACCGCCCCCGCTACGACGCTTTCTCCGGCGTGGTCCCAGGCCGCCACCCGCGTTCGTCGTCCGCGGCCCACACCTTGCGATGTCCAGGCCCGACGCGCGTGAGAGAGTTCTTGCAGCTCGGCGGCCACTCAATGTGCTGGCGGTCGGATCGGCGGTGTGGCACGTGGCGGGGTAGTCGGCAGGCTTGCGGCGGCGAGGGTGCGTACGGCCCTGGGGATAATGTCGTCGCGGAGTGGCGAGGCTTGCACCGTGGGCTGGCTCGGTCTGCTGGTAGCACCCGCCACATACCACACGGGTCGGAGAACCTGCGTGCAATCCATCTTGTTTAATCATGCGAAACGATCCTCATCCACCAAATACTCTTGATCAGATCTCCCCAGAAGTTCTCTTCTTGTATTCAATAGTACTTCTTGGCAGATTTCAGTAGTTGCAGTTGATTTACTTGGTTGCTGGATACCTTTTAATTGATTCTTTAGCACTTTACCGTTGTTTGCTTGTTCAGCTGCGCTTGTTTATTTGCTTAGCTTTCGTAGCGACGTGTTCACTTTGCTTGTTTAGATGAATTGTCTGCTCCATGACAAGCGCCTCTATTTATACTCAACTCTCTTTTTCGACAATCAGTGCTGCTCTCTCGAACCAACGAGAGCAGTATGCCGTTACTGTGACAGAGTGAGAGAGCATTAGTGCAGAGGAGAGACCCAAAGAAAGAGAGAACTCATGAATAACGGCCAGAGAAATTTCTCAAGTTTTTCTTTCTGCCAAACAATGATTCAATAACCAGTTGTTTTGGGGATTCCCAAGGGATAAATTCAATAGCCTGATGCGGTATATACTATCCTTACGCATCTGTGCGGTATTTCACACCACGTAGACTCTAGAGGATCTGACAATGTTCAGTGCAGAGACTCGTACGGCTACGCCTCGTGGACTTTGGATTATTAACAATGTTTATTCTTGCCTCTAATAGTCCTCTGTGGCAGGTCAAAGATTCTGTTGACTAGCGAGCCTGTTTTGTTCAATACCAAATTTTGTGCGTCAATATTCCTCTGCAACTTGGCATTTGGCTGCGCCTACATGTACCTCATCTATAAACGCTTCTTCTCTGTATCGCTCTGGACGTCATCTTCATACGTGATCGATATTTCACTGTCAGAATCCTCTTAATAAAGCTCGTCATCGCTTTTGAAAGAGCGAAAGTATATATCTGTCTAAAGACTACCCCCCATTTTATTACTATATTAGTCGATATCTAACAAGAAAAACCTCTTCTCTAATAAGTTATCGTAATTAGAACATGAAATAACAATATAATTATCATTATGAATTTAAATCTTAAAAAGTCATAAGATATGTCATTCATCGAGCACAGCTCGGTCGTTACTGGTTCAAAAATCAATGACACTTACCTGCAATGCGCCTCTACGGGAGGGCTCAAGCGGCGACTGAGATGTCCTAAATGCACGGCGACGGATTCGCGCTATTTAAAAGAAGAGGCAATATTTCAAAGAATGCATGCGTCAATTTTACGCAGACTATCTTTCTAGGTTAATGAGCTAACCCTCTTTGTTCGTTTTGGATATCATTTATGGCGTTTTTCATATTTCAAAGCATCATCTTCGTCCAGTACCGAAGTGATTTCATTGCTATGCCGATGCCGCTTATATCAAGCGGCATATTATTCATTAGATGTGATATCGAAGAATATTCTTTCAAAGGTTTAAGTAACGAGTTTTATAAGGGGTGGATCAATTTATGTTTAGTAACGACGCAGCGGTGCTGAGTAATTAAAGGATTAATGAGAAATAATGCTAACATAGTAAAAGTCATTTGTAGGTTAGAAGATGATAAAAATAGCAACTAGTTAACTATGATATTCAGATAAGTACAATCTCTTTTACAAATATATAGTTGATTTTAAATATAAGTAACATGAGTAATGTAAATATTAAAATAATGTAATATAAAATTTTTTGAACTAATTGCTAGAATTGGCACTTGCCAGTTTTATTCCGTCAAAAATGGTACTCACATGTCTTCTGTTTATTAATACAGTATGACATTGTTGTTGTTGTAAACTTGAGAATCACTTTATATTAGACTCCCATATTAGCTAGAGGAAGCTTTTCAAGTCTTAAATGGTTTTTAGATGGCAAGTCTCCAACATATATTTTATGAGGCGGATTTGTATCATAGTAGGATTTTGGTCTGTCTTTGGAGTTATCGATGTTTTCATTTCTTTTGTGAATTATTTCAGACTGATATTTGGAACATCTGACGTAGTCAGGGTAAGTATTAAGGTCTTTATTTATAATATGAGTCAAGAGGAATAATCTGCTGCTGACCGAATAATAATTCATGCATAGAGGAAATTAGAAGTGAGTGAATAGCCGTATAGCTTAGCATTGCTGTGTAACCTGTCAGGGCCAAATCACTCTTTGATTGTCGTTCACAAATGATTTGGAGTTTCTCACGAGTGTGGAATGGCTTCTCTCCTAAAGCTCTCATGGGATTGGGGATGGTATGGCGTACAAATAGTTTTTATTTTCAGAAAGGGAACAAGTGCTTTTGAAGGTCTGAAGTGAAGTTAGTGCTAGTCAGTGAGAATGAGTATTAATTATTCGAAAAGGGATATGAAGTGGATCAAACAGTCTGTGGTTCTTCAGCTGATACCACTCCTGTGGAGTGCAGCTGCTGAATATTTAGTAAGATGTCGTCTTGGGTGTCATGACATATTTGAGTTTTGCTGTTCCTGATTCAGGTAAGGTCCGGCAAATATCAAGCTGAGGCCTGTCCCTTTGGAAAGGGCTTAGTGGAAGTAAGTGAGTATGATCTGCATCGGTGCTCGATTGCACCTTCTAAGAACTTTGTTTTCTTGACATAGGGTACAATTTTTGATACTATTTTCAATATCAGGTTTATTCCTTCCAATAGTATTTTCTTTTTATTCTGCTTACTTATTCAATTTCTACCTAAATGGCCACTATAGGAATATCGTGGTTTTCTTTAAGTATTTTCTATTCTCAGCAGGGGATATATGATGCTGTTATGATATATGTTAACGATTATGTTGTTGTTGTGGAATATCTACTAGGATATTGTAGATCTTGGCAGAATAAGTCTTGATCAGAAAGGGTTTTGAAGTCTGGGAGTAGCAATTTAGTTATAGGAGGATTCAGTGTTGATAAATGATTTCTAGTTGTTTTGAGAAGTTTGAAATATTTCAGGATAGGACAATCGTCGAAGTGGTGTGCTTTGACGAACTTGTGAAGTATATGTTGCTATTTGCCGAAAGGACTCTTCATGCAGTTGTTTTTCACAGTATAGTGTTTCGTCGGGATTGGAAAGGAGTTTCTGCATTATTTCAAGACATAGGGTTCAGATTCGTCCATGTCTATTGACGTCGGGGACTAGTATCGTCTGTAATAGGTTGTTTTTAAAGGGTTCTGATTTTGATCAACTCAACTGGGTATTGGAATTTGGAATAGTCAGTCTTCTGGATGTTATACAGGGTTCGAGTTTGGGCTTTGTGAGTCAGTGAGGTTGCTGTGGTGAACGCAGTTCTTGATAATAAATTTGAATGTCATTAGTATGGGATTGGTAGGTTGTTTTAGTTCAGAAAGTTAACAGTTTAGTTAGTAGCATGTCTGTTGTCTT
@67da0424-e19d-4d7e-9a46-f089aa2a0a93 runid=3fa2c7a1eaa486d9b2e98868e6712a02ffbacde7 sampleid=11line_genome read=36810 ch=446 start_time=2020-10-28T09:07:28Z
GTTGTGCTTCGTTCGGTTAGGTGGGTGTTTTAACCGTTTTTCGCATTTATCGTGAAACGCTTTCGCGTTTTTCGTCGCCTTCAGCTATAATACGGCCATTCACTCCACACCAACTTCTCCCCATACGAATTGTGTTCGGTCACAAGGCATTTATTCCTGACTCCATTTATAAACAGACCTTACTACTTACCTGACTACGTCAGAATATAGCATCGTCTCAATCTTAGGCCAAAAGCAGCCAAAAACATCGACAACTCCAAAGACAGTCAAAATCCTACTATGATAACAAAACTCGCCCTATAAAATATAAGGTTGGGAGCTTCCGTTTTACCTAAAAAACCATTTAAGACTTCGAAAAGCCTCTCGCCAATATGGAAAGGCCCATATAAAGTGATTAAGTTCACAACAACAACAATGTCTCTATTAATAAACAGAAGACATGTAAGGCACCATTTTGACGAAATAAAACTGGCAAGTGCCACTCTAGCAATTAGTTTAAAAATTTTTATATTTTACATTATTTTTAATATTTACATTACTCATGTTTACTATATTCTAAAATCCAACTATATTAGTCATGTAGTTATATCTCAATTTTAATTAATTTAGTTAACTAGTTACATTTTTATCATCTCTTACTAACTCGTACGACTTTACTATGTCATACTATTTCCTACTAATCTCCTTAATTAATTAAGCACCGCTGCGTCGTTACTAAAACATAAATTGATCCACCCCGCTTACATTCGTTACTTAAACCTTTTGAAAGAATATTCTTCTATATCACATCTATTGAATAATGAGCAAAGCGCGCTTGGATAAGCAGCATCAGCATAACAATGAATCAATTTTCGGTACCCTGGACGAAGATGATGCTTTGAAATATGAAACGCCATAAATGATATCCAAAACGAACAAGAGGCTAGCTTCATTAACCTAGAAGATAGTCTGCGTAAAATTGACGCATGCATTCTTGAAATATTGCTCTCTCTTTCTAAAATATAGCGCAGATCCGTCGCTGTGCATTTAGGACATCTCGGTCGCCATGGGCTCCCGTGAGGCGTGCTTGTCAATGCAGTAAGGTGTCATGATTTTTGAACTATAACGACCGCGTGAGTCAAAATGACGCATGATTATCTTTTACGTGACTTTTAAGATTTAACTCATACGATAATTATATTGTTGACTTCATGTTCTACTTACGTGATAACTTATTATATATATATTTTTCTTGTTATAGATATCGTGAGCTGTATATAATAAAATGGTGGTTCTTTGAACGATGAGCATATCCTCTCTGCTCTTCTGCAAACGATGACGAAGAGCTTGTTGGTGAGGATTCTGAGCCAGGTAGAAATAAATCAGAATCACGTAAGAAGTGAAGATGACGTCCAGGCGATACAGAAGAAGCGTTTATAGATGAGGTATGGAAGTGCAGCCAACGTCAAGCGGTAGTGAAATATTAGACAGACAAAATGTTATTGAACAACCAGGTTCTTCATTGGCTTCTAACAGAATCTTGACCTTGCCTGAGGGACTAATAGAGGTAGAATAAACATTGGTCAACTTCAAAGTCCAGGCGTAGCCAGTCTGCACTGAACATTGTCAGATCCTCTGGAGGTCTATGCGGTGTGAAATACGCACAGATGCGTAAGGAAAATACCGCATCAGGCGAATTAATTTATCTAAGTCCCAAAACAAACTGGTTATTGTGGTAGGTCATTTGTTTGGCAGAAAGAAAACTCGAAATTTCTCTGGCCGTTATTCGTTATTCTCTCTTCTTTTGGGTCTCTCCCTCTCTGCACTAATGCTCTCTCACTCTGTCACACAGTAAACGGCATACTGCTCTCGTTGGTTCGAAGGCGCGCCTCGAATGTTCGCGAAAAGAGCGCCGGGTATAAATAAGAGAGGCGCTTCGTCTACGGGCGACAATTCAATTCAAACAAGCAAAGTGAACACGTCGCTAAGCGAAAGCTAAGCAAATAAGCAAGCGCAGCTGAACAAGCTAAACAATCTGCAGTAAATTACAAGTTAAAGTGGGTCAATTAAGTAACCAGCAACCAAGTAAATCAACTGCAACTTCTGAAATCTGCCAGAAGTATTGTATGAATGCAAGAAGAGAACTCACAGGATCTGATCAAGAGACAGGATGAGGATCGTTTCGCTGATTGAACAAGATGGATTGCGCAGGTTCTCCGGACCTGCAGGCATGCAACACCATGACCGAGTACAAGCCCACGGTGCGCCTCGCCACCCGCGACGACGTCCCCAGGGCCGTACGCACCTCGCCGCCGCGTTCACCGACTACCCCGCCACGCGCCACCGTCGATCCCGGATGCCACATCGAGCGGGTCGCAGGCGCAGGGCTCTTCCTCACACGCGTGGAGCCGACATCGGCAAGGTGTGGGTCGCGGACGACGGCGCCGCGGTGGCGGTCTGGACCACGCCGGAGAGCGTCGAAGCGGGGGCGGTGTTCGCCGAGATCGGCCCGCGCATGGCCGAGTTGAGCCGGTTCCCGGCTGGCCGCGCGGCAGCAGATGGAAGCCTCTGGCGCCGCACCGGCCCAAGGAGCCCGTGGTTCTGGCCACCGTCGGCGTCTCGCCCGACCACCAGGGCAGGGGTCTGGGCAGCGCCGTCGTGCTCCCAGGTGGAGGCGGCCAGGCGCGCCGGGGTGCCCGCGCTTCTCTGGTTTCACGCCCCCGCAACCTCCCCTTCTGAGCGCTCTCGGCTTCACCGTCACCGCCGACGTCCGAGGTGCCGAAGGACCGCGCACCTGGTGCATGACCCCACAAGCCCGGTACACGACGCCGCCCCACGACCGCAGCGCCCGACCGAAAGGAGCGCGACCCCATGCATCGATGATATCAGATCCCGGGATGCAAAAGTGATCTATTAAACAATAAAGATGTCCACTAAGATCATTTCCTGTCATACTTTGTTAAGAAGGGGTGAGAACAGGTACCTACATTTTGAATGGAAGGATTGGAGCTACAGGGGTGGGGTGGGGTGGGATTAAATCATCACCTGCTCTTTACTGAAGGCTCTTTACTATTGCTTTATGTAATGTTTCATAGTTGGATATATAATTTAAACAAGCAAAAGCAAATTAAGGGCCAGCTCCTTCCTCCCCACTCTTGATCTATAGATCTCGAGCTCAAGCTTGATCGCGTTACCGCCTGGTGACAAAAACGAGTCAGCCCGCAGTTGGTGGAAAAACAAACTTTGGAGCCGATACTGTAACAGGGTGTGATAACGGCTCTTTTATATAATTTATCCTCACGAGTCGGTTCTCATTTGCTAAGGTGTGCCTCGAACAGTGCGCATTCGCATCTACGTACTTGTCTTATTTAATATTATGTAAGTTTAATTTAAAATTGCATGAAAGAAAAAAAAACATATTTATTTATTTGTAAAATTTAATTTTGAGTTCTCAGGTCCCTTTACCTTTATTATTATATGTTTGAGTGTTTTTTTTAATAATACATATATTAACATATTATTACATAATTGTTATAACTAGTGAAGTGAAATTTTTATAAAAAAAAACAGTTTTCAGAGAATGGTATTACCGCAGATGTTAATAAACACTTTATAAATAAGAAATAAGTTGTGGACTTTTTTATTTCAAAGGTGTCCTCGCATCTGATCAATTCGAAACGAAATTGGGAACAGTGAATTATGAATCTTATACAGTTTTCTTTAACGTCACTAAATAGATGGACATAAATAATTTGTCGTTTTACTTAGTATAATGTATGGAATGAGAATGTAGTTTGAATTGTTTTCTTTTTCTTGCAGACTAATTCAAGGATCCACTGGTGCCACCATGGTGAGCAAGGGCGAGGCTGTTCACCGGTGGTGCCCATCCTGGTCGAGCTGGACGGCGACGTAAGCGGCCACAAGTTCCAGCGTGTCCGGCGAGGGCGAGGGCAGTGCCTGCACCGGTAAGCTGACCCTGGCAAGTTCATCTGCACCACCGGCAAATGCCCCGTGCCCTGGCCCACCCTCGTGACCACCTGATACTCGGCGTGCAATTCTTCAGCCTTTACCCCGACCACATGAAGCTGGCGACTTCTTCAGAGTCCGCCATGCCCGAAGGCTACGTCCAGGAGCGCACCATCTTCTTCAAGGACGACGGCAGCGCTACAAGACCCGCGCCGAGGTGAAGTTCCGGGCGACACCCTGGTGAACCACATCCCGAGCTGAAAGGGCATCGACTTCCAAGGAGGGACGGCATCCTGAGCACAAGCTGGGTACAACTACAACAGCCACAACGTCTATCATGGCCGACAAGCAGAAGAACGGCATCAAGGTGAACTTCAAGATCCGCCACAGCAGCATCCGAGGACGGCGGCGTGCAGCTCGCCGATACTACCAACAGAACACCCCATCGGCGACGGCCCCCGTGCTGCTGCCCGACAACCACTACCTGAGCACCCAGTCCGCCCTGACAACAAGACCCCAACAGAAAGCGCGATCGCGGTCTGGGTTCGTGACCGCCGCCGGGATCACTCTCGGCATGGACGAGCTGCAGAAATCAGCAGCCGCGACTCCTAGATCATAATCAGCCATACCACATTTGTAGAGGTTTGCACTTTACTTACCTCCACCTCTGAACCTGAGCATAAAATGAATGCATTGTTTGTTGTAACTTGTTTGTGCAGCTTATAATGGTTACAAATAAAGCAATAGCATCTAAATTTGCAAATACAGCATTTTTAATTCTAGTTGTGGTTTGTCCAAACTCATCAATGTGTATAAGGCGTAAATTGGCGTTAATATTTTATTTAAAATTCGCGTTAAATTTTTGTTAAATCGCTCATTTTTTTTAACCAATAGGCCGAAATCAACCAAAATCCATATAAATCCAAAAGAATAGACCGAGATAAGTTGAGTGTTCCAGTTTGGGTAAAGAGTCCACTGTGCAAGAACGTGGACTCCAACGTCAAAGGGCGAAAGAAAAACCGTCTATCAGGGCGATGGCCCACTACGTGAACCATCACCTAATCAAGTTTTTGGGGGTCGAGGTGCGTAAAGCACTAAATCGGAACCCTAAAGGGCCCCCGATTTAGAGCTTGACGAGAAAATAGCGACATGGCGAGAGAAAGGAAGGGAAGAAAGCGAAAGGCGGGCTAGGGCGCTGGCAAGTGGCATTCACGCTGCGCGTAACCACCACACCGCCGCGCTTAATGCGCCGCTACAGGGCGCGTCAGGTGCACCTAAAAATCTTTTTGAACCCCTATTTGTTTATTTTCTATCTGTTCAAATATGTATCGCTCATGAGACAACCAGCCACAATAAATCATTCAATAATATTGAAAAAGGGAAGAGTCCTGAGGCGGAAAGAATAGCTGTGGAATGTGTGTCAGTTAGGGTGTGAAGATGCAGGCTCCCCAGCGAATCGAAGTATGCAAAGCATGCATCTCAATTAGTCAGCAACCAGGTGTGCAGAGGTCTGACAGCAGTAAAGAGTATGCAAGCATGCATCTCAGTAGTCAACAACCAGTCCGCCCTAATAGCCCATCCCTTTAACTCCCGCAGTTCACTTATTCTGCCCAGCGCTGTTTACATGGTAAAAACACTCTTTCAGGCTATTCAAGTAGTGAGAGGCTTTTAGAATCATGTAGTGAGACATTGATCAAACAAACTGAGATACCGGAGAGTACTGAAAAACTGTAGTCGCTCCAAGGCCAGTGGAACATCTGATGTTTTGTTTTTTGACGGACCCCACCACTCTGTCTCCTTATAAACCAGAAGCCAGCTAGATGGGTAGCCTTGTATCATCTTGTGATGAGGATCTTCTATCAACAAATTATAGTAAACCATAAATGGTTATGTATTATAATCAAACTAAAGGCAGGTGGACACATAGATCAAATGTGTTCTGTGATGACTGGTAGAGGCGAATAGGTAGCCTATGGCATTATTGTACGGAATGATAAACATTGCCTGCGAATTGCTACATTATATACAGCCATAATGTCAGTAGCAAGGAGAAAAGGAGTTCAGATCGCAAAAAATTTATGAGAAACCTTTACATGAGCTGACGTCATCGTTTATGCGTAAGCGTTTGAAGCTCCTACTTTGAAGAGATATTTGCTGATATCTAATATTTGCAAATGAAGTGCCTGGTACCTCAGATGACAGTACTGAAGAGCCAGTAATGAAAAAACGTACTTACTGTACTTACTGCCCCTCTAAAATAAAGGCGAAAGCCAAATGCATCGTGCAAAAAATGCAAAGTTATTTGTCGAGAGCATAATATTGATATGTGCCAAGTTGTTTGACTGACTAATAAGTATAATTTGTTTCTGTATGTATAAGTTAAAGCTAATTACTTATTTTATAATACAACATATTCTTTTAAAAGTACAAAATAAGTTTATTTTTATGTAAAAGAAGAGAATATTTAAAAGTTTTATTTACTTTATAGAAGAAATTTTGAGTTTTGTTTTTAATAAATAAATAAACATAAATAAATTGTTTGTTAATTTATTATTAGTATGTAAGTGTAAATATAATAAAACATATCTATTCAATTAATAAATAAACCTCGATATACAGACCGATGGAAACACATGCGTCAATTTTACGCATGATTATCTTTTAACGTACGTCAATATGATTATCTTTCTGGGGTTAACTAAGGAACAAGTTGTGCTGTAACCAAATCAACTATACAAACGTTCAATGAAACTTTCAATGTCATAAAGAAAATGAAAAACTCCAACGTGGCTGTCAACTTGCTCAATTGAGAAACTATCGCGAACATCTAGTAATATATTAATCAGTTCCCAATTCAATATCGTATTTACATGATAGAGCTGCCCTCTTGTGTTTGTCTTCCAATTGGAAGTGTTACAAATTCCATTCTTTTTAGTAAATTAAATATTATACATCCATCTATTCTAACGCCAAATCAAGTGCAAGAACTTGTCGAAGATCTGACACTTACTATGACTTAAATTAGCCACAGTCTCGATTTAAAACACATACATACTTTAATGAAAATTTCTAATGTTATAAGTTACTTCTTTAACATTAGGATCATGTTCGTTTTTACAAATCCCGTTAGTGAACCTCAAGAATTCAATATTATACCTCTGTATCCCATTACCTGTACCTCATAACTTCCACAGCGTAGTAACTCACTTCAGCACCGTAATTCCCGAATGAGTACCTGCGATTAGTAGTTAAAACTAGTATAGTAATTTGGATCTATTAATCTTAATCAATCAGTGTCTTACCTGTTTACAATATGTAAAATTCTCAGCCATAAGTCAATCTGCAAGCGTTAGTTTCTAATATTACCACCTGCCAACTCTATGTAAACTAGAATTTATCCACGGAATCATAGATGTGTGGGAACCACTCAATAACAATAAATGGATATTTGTTCAAATCAAACCAAGTAAACTGTCAATCGATTGGCCGGGCCTAAGTAAAGACTATATTATATCAGGCACGAATCGTAACTATCCGATACATGTAAAAGGTTTCCTGTAAAGATACCCGTGATATTCTAATTCAATATCATATTATAAGTCATCCTACTATTAAGTTGGAGTTTTAATATATTAAATAGTTCTTAATTGTCCAACTTTACAGGTATTCAAAGCCGAAGATGGCATTTTACATTAAGCTATTTAATAACTCCGGCGTAACTTACCAACCATCAACTGAAAACAATTCAGCTTGTTCCAGAATAGACAAAATAATCGAACATCTAATCATTTAAAATATGACCTTTACATTATTACTCATTTGTATTTATTCAATCTATTATTGTATTTTATGTAAACTACCATCTTATTATAATGATATTAACAACTCGATGACGCAGAAGATCCAATGATGTCATGTATTAGAACAACCATTCTGTCCGGAGCGCTCATTCTCCGTCACTAGGCTACTTGTAACATAATTACCCAGCATCCTCGCGCTTCTCTGTCCTTCCCTATATTAATGGCATCCCCTACCAAATCTATAAATCTCTTCGATCATATAACAATCAATGGCTTGAAGGATCTATTTCAGTTTATTTATCGAGGAGGTATTTATAACCCTGGTGTGAACTATTGGCTGACGGCTAACTCAACTGCACGATGCTGTTGAGCTCTCTCTGTTCCAACCGCCTGAAACGGACGATCTTAACAATCTTTCGACGGGTTGGTCGCTCGTTAATCTCATTGATGATTATAGTCTATCTCATCATCTAATCAAATTGCGCGTGGCTGTAATTCAGGACCTCCATAACTTCGTATTTCATTTTAAAATCTACGTGGCAGATCCCGCTATAACAACGCTAATATTCAGCACCAATGAAACATAATATGGGGTTGGCGGTATTCAGAAAATTATGAAATTCAACTTTATAACATAATCTCACTCTTTTTTATTTAATTTATGCATGTGTTCTATTGATCATTATAAAGACATTCCCTGTATATTATTATAAACCTTAGATGTTGTGAAATTATTTAATTTATTTAAAATGTGAATCAATTTCTTATAAATAAATCATCATCAATTCAGTTTTCTTCTTATTATCTAAAAAAACAGTATATTTTTACTTGACTATCTTTGGTTAATTACATGACAACCATCTTAGGTGACATTCAAATAGTTAATGTAAGTACTCAGAATTACCTTACCAACAAATAATGCTCAAACATACCATTCTATATTAAATCAAATATAATATTCTTATCTTTATTTACTCAATTCTGTGTTCTAACTGTTTCAATACAACTACAGATACTGTTCACTGTTTTAACGGCTGTGGAGTGGTGATCAGTGACATGGTCACTGCACAAGAGTGCGCAGGTTTCGAATCCATAAGGAAGATATTTATCTGATGTCTCAAATGTGTTTTTCCGGGTTATGGATGTCTATTAAATATATGTAGTGTGGTATAATAAAGAATCTTACATTTACCTCGTTATCTGTTTTCTTAACACAAGTTCTTTGAACATCACGGGACCGATTAACGTGGCGTGATTGTTAGTAATATTTATTTCTTTATTTATTATTATAATCTATACTATTATATAAATCTGTTGGTTTACGGATGTTTCGTTATAACTACTACCAAGTATATACGATCGACTTGAGCAGTATCAGGTAAAAATGCATGTTGCTAATGGATGGCTAATATTCTCTATGATCTTGGTTTCCTACGCAGTTGCAGGGGCGTTAATTATAAGATCGCGGGGTGAGAAATAATAGTGTATTTTAATGCCAGCCAAGCGAATAAATTTAGCTAGTTGCTTATAATTTGAATGACGGTGCAAACACCAAGCAACTGTTGTATATTATTCATGGGAAACGCAAGGACGTCTTCCCATTTCTATGACGTTGGAGGCTAAAAAAGTTGTCGGGTGATGATGATTTAGCAATTTATTAGACAAAAGAAATATCGTTTATATTTTAAACGATTACCTTTCTCATCCAGGTTTAAGAGAAATGTTTCTGCAGCTAAATTAGTTATTATTAATTGTTTCTTGGAAATCAATAATCGCTCTCATCTATACTACAGTAATAAGTTAATTGTGGTTCAATGTTGCTAGAAATGGCCACTTACCCACATTTTGTTATTATATCCTCATAATAATAAATGAATGCAATCGGAAGCTGGCAACGATATTGTTGTTGTTTTTAAATTCGCCAACAAGCGACAAAAGCATCCTTCCCGACTGATATACCATGTAAGTTATATATTTTTATGTTAATAAAAAGTCGGTATCACTTTTGTGATTTTGGGAGTTTGACGATCAACTCGATGAATAGCACATTGGTGACGTGAATTTTACCAGACCTTTTATCTTGAAAAAAAAAACAGTCACTGCTATGTGAGCTGGCTTTATTCCAATGCCTCAATAATCCTGAACAACGATTGGTGGCGTTTAATCTACAAAAAACAACACCCAATTTGTATATTATATATCACAATAAGCTATTAAAAAACATTCAAATAACTTCAAGTGACGCTTCACTCAGGTTGCTACCAAAACTCTCTGATCATATATAATCAGAATAGAGTAATGGTAGGCCCATCGAATTTTTACTAATGGAATCATTAATTTCTAAAAATATTAAAATAATTCACGGTTTTAAATTATAGTATTATTACAATACATAAATATTGAATTGAGCAACAATAAACTAAAAAGTCTGTGAATTATAACCAAATTAGCTATTTTTAATTTGTTGTTCAAGTCTGAACAACTCTTTCGTTTGTCAACATATAGGTTTACTATAAGGCTGTATGGGCTAACTGCCCTTTGTCTGTGAATCAGTTTTGGGATGTTATCAAATAAGTAATTTATTTTTATGCAAAACAATGCCAAGGGTGAAAAATGTTGATACATAAACTAAACAACATGAAAAAAATAAGGCATAGTTTTCAAGTACAAATAGTTTTATTATGATGTTGGCCCACTTTTGGGCATTGTCCTTTACTAATAACACAACTTTATAATTCATTTTGTTCGTAATATCGACAGCCCTATAAATATTACATAGTCCGTCAATCATGTTGTTCGCACGTGGTGCGTCCTTACATCTCAGATACCACGTGCTCAACGAATGGAACCCCACAAACTGAAAATTTGGAGGTCTGACCAAATTTAAAGCATATGTACTTGTACTTATTTTTGTACGAGATGTAGGTATTTAGCGATTAATATTTACGCCAAAAGTGACAATGACACTGAATTCTGCGATCTTATTTTTAAATATTGGTGTCATTAGCTTTTGGTAAATATATTCCGGTAAATAATAATCATACATTTCGAGAAACAGTGTAAATTGTTCGACTCAGTCGATTTGTTTACAATACTGCCCATAGTACATTTAAAATTTCAAACACACAATTCATTTAGTTACGAATTGACCTCTGTTAGTGTCAAACAGAATTTCAATTTGATAAGACCCTGAATATTATTCAGTCACTCCAGAAGGTTACATATCTACCCCTCTACCTTTATTCTTTCAGTCTCAATGTTATGAACAT
@7bd7fa45-111d-4271-bfc3-bfedef929edb runid=84b250a8bf9dd6cb08d0e093a8666cf11c5b0715 read=2944 ch=461 start_time=2020-10-29T04:35:13Z flow_cell_id=FAM93798 protocol_group_id=11line_genome2 sample_id=11line_genome2
CGGTACTTCGTTCAGTCGTTTAGATTGTTTAACCGTTTCCCGCATTTATCGTGAAACGCTTTCGCGTTTTCGTGCGCCGCTTCACGCGTTAAGTCTGAATTGCCGGATGTTTTGAAAGTTTTCCCCTAAAAGAACGGTTGGGTATTGAGTCGTTTAGTGGTTGGGGTCTAAATAACATAATCGGGCCCCGGTTCGCAGTCGCGGACCAGTCCCCGCACTTAAGGGGGGCGCGCGGAAGGACCTCATGGGAGTTCCACCCCCGGCAATAAAAACAAGAGGCGTGGGTGTAGCTTCCTGTGCGATAGCACGATCGCAAACTAATGTTTCTCGCATGAACAATACGCGAATTTAATGAGCGAGATAGGTGATTTGCCGTCGCTCCATATATATGTATTCCGGCACTAGCTGCGCTCGCGGCTTCGCCCGCAAAGAAATGCAATTTTAAATTGTAGCATTAAATTCGTGAGACGATTCTTACGACATTCATATCGCCCTTTGCACGTGTGCAAAGTTTCATATCGATTGAGTAATGGTTTCTCAATTTTTAGTTTGCACATCCAGTTATTATATTGATTTATTGTTTTTGTTTTTGACGTGACAACGTCTTATAATTCGATGGAGCCGGCTGCACGCACGAAAAACATGACTCATGCGGCGTTACCTCGCTCTGAGGTAGCAATTAAATATATTTTATGTTCAGTGATATATTGTCGAATATTCGTGCTTCCATCATTAAAATAAGCAGCATCGGTCCGCTAGTGCAGCGATTGTAGGTTATGCTATAATTGATAAAACCTATAACAATAAGTTAACAGAACTATTTCACGATGAGTAAAAAACCATTCCATCAGTATTGTATCATAGGACGTTGTCACGTTCAGCTATCTTCAGTAAACCGACTTTACAGACAATCGATTTTTCTATTGACACTTTGGATCTTACTCCTCTTAGCCCCTCTGAGCCCCCATCCAAATAAGTCTTGAACATAAAGTCACATAACATAAAGTCTTTGACAAAATAGAGACCATAATAATGTTTAAACTTATTTAAGTTAATAATTATGGTCAATTTTGACCACTGGGCATTACTAATTTCTATAGTTTCGCTCAACGCGATGCGATATAAAATGGGTAGAAAAAAAATTGTTGGTTCTGTTATGGCGGGATTCGCTACGTGAATTTTAAATGAAATACGAGTTATGGAGGTTCGACGATGATGCGCACTGATTTAGGAGGATAAGGAGAACTTGACCGCTCAGGTCGAGAGATTGAATCAGAGTTGACCGCTCGGGTCGAAAGATTAGCTAAGACTGTCCGTTTGCGGGGCGGTCGGAACAGGAAGAGCTCAGATGCTGATCGTGCAGCAGTTAGGGCTGTCCAGCCAAATAGTGTTCATACTAGGGTTATAACACCTCCCCCATGGGAAATAAACTTAGGGGCTTGATCTCTAAGTTTATTGTTTGAAATGATGCAGTGGATCTGGAAAGGATTTGTGGAATTTGGTAGGGGATGCGCCATTATTATAGGGAGTTGATGAAGAAGGCGAGGATGCCGTGGTTCTAGAGTTACGGCGAGTCTTGGGTGACAGGTATTTAGTGCTCCTGGATTATGAATGGGTTGTTCTGGATTGTTTACACGATGATCATTTAGGGTCTCTGTTGCGATCGTGAGCGTCGTTGGGCTTATTTATTTTATAATAGCGATACAGTTTACATAAAGATACAATAATTAGGTTAGAATTAGAAATAACACAAAGGGAGGAATATTGTAAAATATATTACGTAAAATGATTAGGATGTTCGATTATTTTATCTAGTTCTGGAATTAAGTTTGGTGTTTTCTATTAGATGGTTAAATAAGTTAAAGGTCAGAAGTTGGTTTAGTTTAATGTGACGTTATTCTCAGCTTCTTCGAATTTAGCAAAAGTTACAACATGAATCATTTAATATCAGTAAATCTAGCAATAGTAGGATGACTTATATTAAGGGGACATTAGAATTGGGAAATAGTCGGTATCTTTACGAAACCTTTACATGTTATCAGGATAGTTACGATTCCCGTGCCTGATATAATATAGTCTTTTTATCTCTAGGTTCTTACAATCGATTGACAGTTTACTTGGTTTTGGGTTGAACAAATATCATTATTGTTATTAGTGGTTCCCACACACATCTATGATTCCGTGGATAGAATTTAGTTTTTATAGATTAGCCACAAGGAAAGAGTGGTAATGGCTTTCTGAAACTAATTCGCTTTCACAGGATGGATTGGCGTTTGTAGAAGAATTTTTACAATGTTGCAAATGTAGTATACATAATTGATTGATTTACATTGGCAGGATCTTAACCCTAGAAAGATAGTCTGCGTAAAATTGACGCATGCATTCTTGAAATATTGCTCTCTCTTTCGTAAGCGCGAATCCGTCGCTGTGCATTAAGTTATCTCAGTCGCCGCTTGGAGCTCCGTGAGGCGTGCTTGTCAATGCGGTAAGTGTCACTGATTTTGAACTATAGCGACCGCGTGAGTCAAATGACGCATGATTGTCTTTTACGTGACTTTTAAGATTTAACTCATACGATAATTATATTGTTATTTCATGTTCTACTTACGTGATAACTTATTATCTATATATATTTTCTTGTTATAGATATCTCGTGACTAATATATAATAAATAAAGGTAGTTGCTGGAACGATGAGCATATCCTCTCTGCTCTTCTGCAAAGCGATGACGAGCTTGTTGGTGAGGATTCACGACAGTGAAATATCAGATCTGCGTAGTGAAGATGACGTCAGAGCGATACAAGCGTTTATAGGTGAGGCCTGAAGTGCAGCCAACGTCAAGCGGTAGTGAAATATTAGACGAACAAAATGTTGTTGAACAACCAGGTTCTTCATTTGGCTTCTAACAGAAGTCTTGACCGCACTTACAGAAGGACTATTAGAGGTAAGGCTCAACATTGTTGGTCAACTTCAAGTCCACGAGGCGTAGCCGAGTCTCTGCACTGAACATTGTCAGATCTCTAGAGCCTATGCGGTGTGAAATACTGCACAGATGCGTAAGGAAAATACCGCATCGAGCAATTAATTCCCATCCCCTAGAATCCCAAACAAACTGGTTGTTGTGGTAGGTCATTTGTTGTAAGAAAAGAAAACTCGAATTTCTCTGGCCGTTATTCGTTATTCTCTCTTTTCTTTTGGGTCTCTCCCTCTCTGCACCTAATGCTCTCTCTCACTCATCACACAGTAAACGGCATACTGCTCTCGTTGGTTCGAAGGCGCGCTGCCCTCGAATGTTCGCGAAAAAGAGCGCCGGGTATAAATAGAGGCTGCTTCGTCTACGGAGCGACAATTCAATTCAAACAAGCAAAGTGAACACGTCGCTAAGCAATAAGCAAATAAACAAGCGCAGCTGAACAAGCTAACAATCTTTTTGATAAAAAAGTGCGAGTTAAAGTGAATCAATTAAAAGCCCAACCAAAGCAACCGTAAAATCAACTGCAACTACTGAAATCTCCTGCCAAAAAGTAAATTATTGGAATACAAAGAAGAAACTCTGGGGATCTGATCAGAGACAGGATGAGGATCGTTTCGCATGGTGAACAAGATGGATTGCACGCAGGTTCTCGGACCTGCAGGCATGCAAGCTTACCATGACCAGTACAAGCCCACGGTGCGCCTCGCCACCCGCGACGACGTCCCCAGGGCCGTACGCACCCTCGCCGCCGCGTTCGCCGACTACCCCGCCACGCGCCACGCAAAATGATCCGGACCGCCGGCATCAGGCGGGTCGCGAGCTGCAGAACTCTTCCTCACGCCGTGGGCTCGACATCGGCTTAGGTGTGGGTCGCGGACGACGGCGCCGCGGTAGCAGTCCTGGGTTCCACGCCGGAGAGCGTCGAAGCGGGGCGGTGTTCGCCAGATCGGCCGCACGCGGCCGAGTTGAGCGGTTCCCGGCTGGCCGCGCAGCAACAGATGGAAGGCCTCCTGGCGCACCGGCCCAAAAAGAGGCCCGCGTGGTTCTGGCCGCATCGGCGTCTCGCCCGACCACCAGGGCAGAGGTGCAGGCAGCGCCGTCGTGCTCCCGGAGTAGGCGGCCTTGACGCCGGGATTGCCCGCCTTCTGGAGACCTCCGCGCCCGCAACCTCCCTTCTACAGGCGGCTCGGCTTCTGCGTCACCGCCGACGTCCGAGGTGCCCGAAGGACGCGCACCTGGTGGTGCTGACGCCGCCCCTGACCCGCAGCGCCCGACCGAAAGGCATGGGCCCCATGCATCGATGATATCAGATCCGATGCGAAAGTGATGATCTATTAAGAAACAATAAAGATCATCCACTAAAATGGAAGTTTTCCTGTCATACTTTGTTAAGAAAGGGTGAGAACAGGTACCTACATTTTGAATGGAAGGATTGGAGCTGGGGTGGGGGTGAGTGGGATAGATAAATGCCTGCTCTTT

#I did BLAST and found that there is an EGFP cassette in torimochi in Bomo_Chr13 11929245 11929246, so I created that sequence by hand
211005_torimochi_chr13_pPIGA3.fas

#Mapping by bowtie
bowtie-build -f 211005_torimochi_chr13_pPIGA3.fas 211005_torimochi_chr13_pPIGA3

QQ="211005_torimochi_chr13_pPIGA3"
for Q in ${QQ};do
PP="D"
for P in ${PP};do
NN="RR000974"
for N in  ${NN}; do
        echo $N
	( bowtie --offrate 3 -p 20 -a --best --strata -v 1 -t --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${P}${N}_trim.fasta.gz  > ${P}${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${P}${N}_${Q}.sam > ${P}${N}_${Q}.bam
bamToBed -i ${P}${N}_${Q}.bam > ${P}${N}_${Q}.bed
rm ${P}${N}_${Q}.sam
awk '$3-$2>22' ${P}${N}_${Q}.bed > ${P}${N}_${Q}_piRNA.bed
coverageBed -b ${P}${N}_${Q}_piRNA.bed -a ${Q}.bed -s -d> ${P}${N}_${Q}_piRNA_plus.txt
coverageBed -b ${P}${N}_${Q}_piRNA.bed -a ${Q}.bed -S -d> ${P}${N}_${Q}_piRNA_minus.txt
done
done
done


QQ="Bomo_genome"
for Q in ${QQ};do
PP="D"
for P in ${PP};do
NN="RR000974"
for N in  ${NN}; do
        echo $N

	( bowtie --offrate 3 -p 20 -a --best --strata -v 1 -m 1 -t --sam ${Q} -f /home/kshoji/Gawain/NGSdata/${P}${N}_trim.fasta.gz  > ${P}${N}_${Q}.sam )  
	samtools view -@ 20 -bS ${P}${N}_${Q}.sam > ${P}${N}_${Q}.bam
bamToBed -i ${P}${N}_${Q}.bam > ${P}${N}_${Q}.bed
rm ${P}${N}_${Q}.sam
rm ${P}${N}_${Q}.bam
done
done
done


####Open R to create a graphs####
R
library(ggplot2)

minus <- read.table("DRR000974_211005_torimochi_chr13_pPIGA3_piRNA_minus.txt")[,8]/20660143*1000000
plus <- read.table("DRR000974_211005_torimochi_chr13_pPIGA3_piRNA_plus.txt")[,8]/20660143*1000000

Y1 <- plus
Y2 <- -minus
len <- length(Y1)


DATA <- data.frame(c(rep("GFP",len),rep("GFP",len)),
      c(1:len,1:len),
      c(Y1,Y2))
	  
colnames(DATA) <- c("PIWI","position","RPM")
p0 <- ggplot(data = DATA, mapping = aes(x = position, y = RPM))
p0 <- p0
p0 <- p0 + geom_bar(stat = "identity", position = "dodge")
p0 <- p0 + theme_bw(base_size = 15, base_family = "Helvetica") + ylim(c(-200, 200))
p0 <- p0 + geom_vline(xintercept=c(5000+0.5,len-5000+0.5),colour="grey")+ geom_vline(xintercept=c(5000+0.5 + 7200,5000+0.5 + 7200+5900),colour="green")
ggsave(file = paste0("221108_","chr13_GFP_pPIGA3","_piRNA_profile1.png"), plot = p0, dpi = 200, width = 6, height = 1.9)
